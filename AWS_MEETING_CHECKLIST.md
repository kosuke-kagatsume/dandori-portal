# AWSエンジニアとの会議 - 確認チェックリスト

**日付**: 2025-11-13
**プロジェクト**: DandoriPortal (HR管理システム)
**進捗**: 95%完成、本番デプロイ準備中

---

## 📋 プロジェクト情報（先に共有）

### 技術スタック
- **フレームワーク**: Next.js 14.2.15 (SSR + API Routes)
- **言語**: TypeScript 5
- **ランタイム**: Node.js >= 20.0.0
- **データベース**: PostgreSQL (現在Supabase使用)
- **認証**: Supabase Auth（デモモード実装済み）
- **状態管理**: Zustand (18ストア、LocalStorage永続化)
- **ビルドサイズ**: 最大220kB/ページ

### 現在の状態
- ✅ ビルド成功（エラー0）
- ✅ E2Eテスト 30/30 (100%)
- ✅ 14ページ完全実装
- ✅ CSV/PDF出力機能
- ⚠️ レスポンシブ対応は一部未完成（残り10項目）

### 予想トラフィック
- **想定ユーザー数**: [ここに記入]
- **同時接続数**: [ここに記入]
- **データベースアクセス**: [ここに記入]

---

## 🎯 最重要確認事項（必須）

### 1. デプロイ方法の選択

#### オプションA: AWS Amplify（推奨）
**質問**:
- ✅ Amplifyは貴社の推奨ソリューションですか？
- ✅ Next.js 14のSSR/API Routesは完全サポートされていますか？
- ✅ カスタムドメイン設定は可能ですか？
- ✅ 環境変数の管理方法は？（Staging/Production分離）

**確認ポイント**:
- GitHubとの連携方法
- 自動デプロイの設定
- ビルドタイムアウト設定（現在3分程度）
- Edge Networkの利用可否

#### オプションB: AWS EC2 + Docker
**質問**:
- ✅ EC2インスタンスタイプの推奨は？（t3.small? t3.medium?）
- ✅ Auto Scalingの設定は必要ですか？
- ✅ Load Balancer（ALB）の構成は？
- ✅ Dockerイメージのレジストリは？（ECR?）

#### オプションC: AWS App Runner
**質問**:
- ✅ App RunnerでNext.jsは動きますか？
- ✅ コストとパフォーマンスのバランスは？

---

### 2. データベース戦略 ⚠️ 超重要

**現状**: Supabase（外部サービス）を使用中

#### オプションA: Supabase継続利用
**質問**:
- ✅ AWS内部からSupabaseへの接続は推奨されますか？
- ✅ レイテンシーの懸念はありますか？
- ✅ VPN/VPC Peeringは必要ですか？

#### オプションB: AWS RDS PostgreSQL
**質問**:
- ✅ RDS PostgreSQLへの移行を推奨しますか？
- ✅ インスタンスタイプの推奨は？（db.t3.micro? db.t3.small?）
- ✅ Multi-AZ構成は必要ですか？
- ✅ 自動バックアップの設定は？
- ✅ Prismaとの互換性は問題ないですか？

#### オプションC: Amazon Aurora Serverless
**質問**:
- ✅ Aurora Serverlessは過剰ですか？
- ✅ コストメリットはありますか？

**データ量**:
- 現在のデータ量: [不明、確認必要]
- 想定成長率: [ここに記入]

---

### 3. コスト見積もり 💰

**質問**:
- ✅ 月間の想定コストはいくらですか？
- ✅ 無料枠は利用できますか？（AWS Free Tier）
- ✅ コスト最適化の推奨事項は？
- ✅ CloudWatch、S3等の付随コストは？

**予算**:
- 月間予算: [ここに記入]
- 許容できる最大コスト: [ここに記入]

---

### 4. セキュリティ設定 🔒

**質問**:
- ✅ SSL証明書の取得方法は？（AWS Certificate Manager?）
- ✅ WAF（Web Application Firewall）は必要ですか？
- ✅ Secrets Managerでの環境変数管理を推奨しますか？
- ✅ IAMロールの設定方法は？
- ✅ セキュリティグループの推奨設定は？
- ✅ DDoS対策（AWS Shield）は必要ですか？

**機密情報**:
- Supabase接続情報
- デモログイントークン
- API Keys（現在なし）

---

### 5. CI/CDパイプライン

**質問**:
- ✅ GitHub Actionsとの連携は可能ですか？
- ✅ CodePipeline + CodeBuildを推奨しますか？
- ✅ テスト実行の自動化は可能ですか？（E2Eテスト30個）
- ✅ ステージング環境とプロダクション環境の分離方法は？

**現在のワークフロー**:
1. ローカルで開発
2. GitHubにプッシュ
3. ビルドテスト実行
4. デプロイ

---

### 6. モニタリング・ログ管理 📊

**質問**:
- ✅ CloudWatchの設定方法は？
- ✅ アプリケーションログの保存先は？（CloudWatch Logs? S3?）
- ✅ アラート設定の推奨事項は？
- ✅ パフォーマンスモニタリングツールの推奨は？（X-Ray?）
- ✅ エラートラッキング（Sentry等）との統合は？

**監視したい項目**:
- レスポンスタイム
- エラー率
- データベース接続数
- メモリ使用率

---

### 7. スケーリング戦略

**質問**:
- ✅ トラフィック増加時の自動スケーリング設定は？
- ✅ キャッシング戦略の推奨は？（CloudFront? ElastiCache?）
- ✅ 静的アセット（画像・CSS・JS）の配信は？（S3 + CloudFront?）
- ✅ APIレート制限の実装は必要ですか？

---

### 8. バックアップ・災害復旧 💾

**質問**:
- ✅ データベースの自動バックアップ設定は？
- ✅ バックアップの保持期間の推奨は？
- ✅ リストア手順は？
- ✅ 災害復旧計画（DR）は必要ですか？
- ✅ 別リージョンへのバックアップは？

---

### 9. ドメイン・DNS設定

**質問**:
- ✅ Route 53でのドメイン管理を推奨しますか？
- ✅ 既存ドメインの移行方法は？
- ✅ サブドメインの設定方法は？（dev.example.com、prod.example.com）
- ✅ SSL証明書の自動更新は？

**ドメイン情報**:
- 既存ドメイン: [ここに記入]
- 希望ドメイン: [ここに記入]

---

### 10. 環境変数・設定管理

**必要な環境変数**:
```bash
# Supabase
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=
SUPABASE_SERVICE_ROLE_KEY=

# Demo Mode
DEMO_MODE=false
NEXT_PUBLIC_DEMO_MODE=false
DEMO_LOGIN_TOKEN=

# Database (RDSに移行する場合)
DATABASE_URL=postgresql://...

# その他
NODE_ENV=production
```

**質問**:
- ✅ 環境変数の管理方法は？（Amplify環境変数? Secrets Manager?）
- ✅ 環境別の設定ファイル管理は？

---

## 🚀 デプロイ後の運用

### 11. デプロイフロー

**質問**:
- ✅ デプロイの頻度は？（毎日? 週1回?）
- ✅ ロールバック手順は？
- ✅ Blue-Green Deploymentは必要ですか？
- ✅ Canary Deploymentは必要ですか？

---

### 12. サポート・保守

**質問**:
- ✅ AWSサポートプランは必要ですか？（Developer? Business?）
- ✅ 24時間サポートは必要ですか？
- ✅ インフラ保守は誰が担当しますか？
- ✅ アップデート戦略は？（パッチ適用、依存関係更新）

---

## 📝 追加質問事項

### 13. パフォーマンス最適化

**質問**:
- ✅ CDNの設定は？（CloudFront必須?）
- ✅ 画像最適化の推奨方法は？（Lambda@Edge?）
- ✅ Server-Side Caching（Redis等）は必要ですか？
- ✅ データベースコネクションプーリングの設定は？

---

### 14. コンプライアンス・規制

**質問**:
- ✅ 個人情報保護法への対応は？
- ✅ データの地理的保存場所の制限は？（日本リージョン必須?）
- ✅ 監査ログの保持期間は？
- ✅ GDPRへの対応は必要ですか？

---

### 15. 他のAWSサービスとの連携

**質問**:
- ✅ S3でのファイルストレージは必要ですか？（CSV/PDF保存）
- ✅ SESでのメール送信は必要ですか？（通知機能）
- ✅ SQS/SNSでの非同期処理は必要ですか？
- ✅ Lambda関数の利用シーンは？

---

## 🎯 会議後のアクションアイテム

### 即座に実施すべきこと
- [ ] デプロイ方法の確定（Amplify vs EC2 vs その他）
- [ ] データベース戦略の決定（Supabase継続 vs RDS移行）
- [ ] 環境変数の準備
- [ ] 必要なAWSアカウントの作成・権限設定

### 次のステップ
- [ ] `amplify.yml` または `Dockerfile` の作成
- [ ] 環境変数の設定
- [ ] CI/CDパイプラインの構築
- [ ] デプロイテスト実行

---

## 💡 追加メモ

### プロジェクトの特徴
- **SSR重視**: Next.jsのSSR機能を多用
- **API Routes**: `/api/*` エンドポイント多数
- **LocalStorage多用**: クライアント側の状態管理
- **PDF生成**: jsPDFでサーバーサイド生成
- **CSV出力**: ブラウザでダウンロード生成

### 潜在的な課題
- ⚠️ LocalStorage依存（サーバー移行時の考慮）
- ⚠️ PDFメモリ使用量（大量データ時）
- ⚠️ データベース接続数（コネクションプール必須）

---

**作成日**: 2025-11-13
**最終更新**: 2025-11-13
**進捗**: 95% → AWS本番デプロイ準備中
